<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0  Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head profile="http://gmpg.org/xfn/11">

<base href="http://collectivecognition.com"/>

<title> Socket.io And Node.js Clustering |  Collective Cognition</title>

<meta http-equiv="content-type" content="application/xhtml+xml; charset=utf-8" />
<meta name="robots" content="index, follow" />
<meta charset=utf-8 />

<meta name="description" content="Collective Cognition designs and develops engaging web and mobile experiences." />
<meta name="keywords" content="collective, cognition, web, design, developemtn, css, html, site, mobile, apps, apple, iphone, ios" />
<meta name="author" content="William Blanchette, Collective Cognition" />

<script type="text/javascript" src="/js/shadowbox-inlined-min.js"></script>
<script type="text/javascript">Shadowbox.init();</script>

<link rel="shortcut icon" href="/favicon.ico" />
<link rel="stylesheet" href="/css/style.css" media="screen,projection" type="text/css" />

<!--<link rel="alternate" href="http://collectivecognition.com/feed/" title="RSS Feed" type="application/rss+xml" />-->

<link href="https://plus.google.com/112066706442483184529/" rel="publisher" />

<meta name='parsely-page'
      content='{"title": "Socket.io And Node.js Clustering",
                "link": "http://collectivecognition.com/blog/socket.io-and-node.js-clustering",
                "image_url": "",
                "type": "post",
                "post_id": "/blog/socket.io-and-node.js-clustering",
                "pub_date": "2013-05-29T00:00:00EDT",
                "section": "",
                "author": "William Blanchette",
                "tags": []
               }'>
</head>

<body>

	<div id='wrapper'>
	
		<div class="bar light">
			<div class="container">
				<div id="content">
							<div class='page white top'>
			
			<div class='header'>
			
								<a href='http://collectivecognition.com' id='logo'>Collective Cognition</a>
								
				<div id='menu'>
				
					<a href='/'>blog</a>
					<a href='/games'>games</a>
					<a href='/apps'>ios</a>
					<a href='http://github.com/collectivecognition?tab=repositories'>github</a>
					
				</div>
				
			</div>
			<div class='background'>
			
				<div class='content'>
					
					<h2>Socket.io And Node.js Clustering</h2>
					<h4><em>Posted on 29 May 2013 by William Blanchette</em></h4>
					
					<p>
					<p>I ran into a problem while working on chat.js, in the form of alot of log-spam from socket.io that looked something like this:</p>

<pre><code>info  - handshake authorized DL6P-B6mDjt1hrhM3VYw
debug - setting request GET /socket.io/1/websocket/DL6P-B6mDjt1hrhM3VYw
debug - set heartbeat interval for client DL6P-B6mDjt1hrhM3VYw
debug - websocket writing 7:::1+0
warn  - client not handshaken client should reconnect
info  - transport end (error)
debug - set close timeout for client DL6P-B6mDjt1hrhM3VYw
debug - cleared close timeout for client DL6P-B6mDjt1hrhM3VYw
debug - cleared heartbeat interval for client DL6P-B6mDjt1hrhM3VYw
debug - discarding transport</code></pre>

<p>The problem turned out to be due to my use of the (still experimental) <code>cluster</code> API causing a race condition in socket.io and causing erratic behaviour in my application.</p>

<p>Luckily, multiple-cpu support isn&#8217;t a huge requirement for me at this time. Just a heads up for anyone else having similar problems.</p>
					</p>
				
				</div>
			
			</div>
			<div class='footer'>
			</div>
			<div id="post-nav">
				<div class="nav-older"><a href="/blog/bare-minimum-javascript-tests">&lt; Previous</a></div>
				<div class="nav-newer"><a href="/blog/obfuscating-sequential-ids-with-skip32">Next &gt;</a></div>
			</div>
				</div>
			</div>
		</div>
		
		<div id='footer'>&copy; 2013 Collective Cognition, all rights reserved</div>

	</div>

	<!-- START Parse.ly Include: Standard -->
	<div id="parsely-root" style="display: none">
	  <div id="parsely-cfg" data-parsely-site="collectivecognition.com"></div>
	</div>
	<script>
	(function(s, p, d) {
	  var h=d.location.protocol, i=p+"-"+s,
	      e=d.getElementById(i), r=d.getElementById(p+"-root"),
	      u=h==="https:"?"d1z2jf7jlzjs58.cloudfront.net"
	      :"static."+p+".com";
	  if (e) return;
	  e = d.createElement(s); e.id = i; e.async = true;
	  e.src = h+"//"+u+"/p.js"; r.appendChild(e);
	})("script", "parsely", document);
	</script>
	<!-- END Parse.ly Include -->
</body>

</html>